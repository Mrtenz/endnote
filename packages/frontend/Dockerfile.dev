FROM node:12-alpine

ARG COMMAND=start
ARG NODE_ENV=production
ENV NODE_ENV=${NODE_ENV} \
    COMMAND=${COMMAND}

WORKDIR /app
COPY tsconfig.json package.json yarn.lock ./
COPY ./packages/common ./packages/common/
COPY ./packages/frontend/package.json ./packages/frontend/

RUN yarn install --frozen-lockfile

WORKDIR /app/packages/frontend
COPY ./packages/frontend .

EXPOSE 8000

CMD yarn run ${COMMAND}
